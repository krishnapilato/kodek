<div class="table-container mat-elevation-z8">
  <table
    mat-table
    [dataSource]="dataSource"
    class="mat-elevation-z8"
    *ngIf="dataSource.data.length > 0"
  >
    <ng-container matColumnDef="id">
      <th mat-header-cell *matHeaderCellDef><b>#</b></th>
      <td mat-cell *matCellDef="let user; let i = index">
        {{ i + 1 }}
      </td>
    </ng-container>
    <ng-container matColumnDef="fullName">
      <th mat-header-cell *matHeaderCellDef><b>Full Name</b></th>
      <td mat-cell *matCellDef="let user">{{ user.fullName }}</td>
    </ng-container>
    <ng-container matColumnDef="email">
      <th mat-header-cell *matHeaderCellDef><b>Email</b></th>
      <td mat-cell *matCellDef="let user">{{ user.email }}</td>
    </ng-container>
    <ng-container matColumnDef="role">
      <th mat-header-cell *matHeaderCellDef><b>Role</b></th>
      <td mat-cell *matCellDef="let user">{{ user.role }}</td>
    </ng-container>
    <ng-container matColumnDef="options">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let user" class="options-cell">
        <button
          [matMenuTriggerFor]="menu"
          [matMenuTriggerData]="{ user: user }"
          mat-icon-button
          matTooltip="Options"
          [matTooltipPosition]="'before'"
        >
          <i class="fa-solid fa-ellipsis"></i>
        </button>
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>
  <mat-toolbar *ngIf="dataSource.data.length > 0">
    <mat-toolbar-row>
      <span
        class="create-user"
        (click)="createNewUser()"
        matTooltip="Create new user"
        [matTooltipPosition]="'after'"
        >Create <i class="fa-solid fa-plus fa-beat"></i
      ></span>
      <span class="spacer"></span>
      <mat-paginator showFirstLastButtons #paginator [pageSize]="8"></mat-paginator>
    </mat-toolbar-row>
  </mat-toolbar>
  <div *ngIf="dataSource.data.length === 0" class="no-data-message">
    No users found.
  </div>
</div>

<mat-menu yPosition="below" xPosition="before" #menu="matMenu">
  <ng-template matMenuContent let-user="user">
    <button (click)="editUser(user, 'information')" mat-menu-item>
      <mat-icon fontIcon="info"></mat-icon> Information
    </button>
    <button mat-menu-item><mat-icon fontIcon="send"></mat-icon> Email</button>
    <button (click)="editUser(user, 'edit')" mat-menu-item>
      <mat-icon fontIcon="edit"></mat-icon> Edit
    </button>
    <button mat-menu-item (click)="toggleLockUser(user)">
      <mat-icon>{{ user.locked ? "lock" : "lock_open" }}</mat-icon>
      {{ user.locked ? "Unlock" : "Lock" }}
    </button>
    <button (click)="deleteUser(user)" mat-menu-item>
      <mat-icon fontIcon="delete_forever"></mat-icon> Delete
    </button>
  </ng-template>
</mat-menu>
